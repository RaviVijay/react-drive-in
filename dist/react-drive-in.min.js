!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.ReactDriveIn=e()}}(function(){return function e(t,i,n){function o(a,r){if(!i[a]){if(!t[a]){var l="function"==typeof require&&require;if(!r&&l)return l(a,!0);if(s)return s(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var h=i[a]={exports:{}};t[a][0].call(h.exports,function(e){var i=t[a][1][e];return o(i?i:e)},h,h.exports,e,t,i,n)}return i[a].exports}for(var s="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(e,t){t.exports=e("./lib")},{"./lib":2}],2:[function(e,t){"use strict";var i=function(e){return e&&e.__esModule?e["default"]:e},n=function(){function e(e,t){for(var i in t){var n=t[i];n.configurable=!0,n.value&&(n.writable=!0)}Object.defineProperties(e,t)}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)},s=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},a=i(e("jvent")),r=i(e("./timer")),l=i(e("./playlist")),u=i(e("./utils")),h=u.getWidth,c=u.getHeight,d=u.setStyles,p=u.findPoster,f=u.createEl,m=u.replaceChildren,y=function(e){function t(){s(this,t),this._listeners=[],this.parentEl=null,this.mediaEl=null,this.placeholderEl=null,this.mute=!0,this.currMediaType=null,this.mediaAspect=16/9,this.playlist=null,this.loop=!0,this.loopPlaylistItems=!1,this.slideshow=!1,this.playlistLength=0,this.currentItem=0,this.slideshowItemDuration=10,this._slideshowTimer=null,this._seeking=!1,this.poster=null,this.loading=!0}return o(t,e),n(t,{_updateSize:{value:function(e,t,i){var n=1,o=h(),s=c(),a=o/s;i>a?(d(this.parentEl,{width:Math.ceil(s*i)+"px",height:s+n+"px"}),"video"===t?d(e,{width:Math.ceil(s*i)+"px",height:s+"px"}):d(e,{width:"auto",height:s+n+"px"})):(d(this.parentEl,{width:o+"px",height:Math.ceil(o/i)+1+"px"}),"video"===t?d(e,{width:this.parentEl.offsetWidth+"px",height:"auto"}):d(e,{width:o+"px",height:"auto"}))}},_setVideoData:{value:function(){var e=this.mediaEl;this.mediaAspect=e.videoWidth/e.videoHeight,this._updateSize(e,"video",this.mediaAspect)}},_setImageData:{value:function(e){this.mediaAspect=e.naturalWidth/e.naturalHeight,this.isTouch||this._updateSize(this.mediaEl,"image",this.mediaAspect)}},_playVideoItem:{value:function(e,t){for(var i,n,o,s,a=this.mediaEl,r=[],l=e.length-1;l>=0;l--)i=e[l],0!==i.type.search(/^image/)||o?n=f("source",{src:i.src,type:i.type}):o=i.src,n&&(s=a.canPlayType(i.type),"probably"===s?r.unshift(n):r.push(n));r.length?(this.emit("media.loading"),a.preload="auto",(this.playlistLength<2||this.loopPlaylistItems)&&(a.loop=!0),this.mute&&this.setVolume(0),o&&(a.poster=o),m(a,r),this.currentItem=t,a.load()):o||this.poster?(this.slideshow=!0,this._createMediaEl(),this._playImageItem(e,t)):this.emit("media.error",new Error("No playable source"))}},_playImageItem:{value:function(e,t){var i,n;if(e&&e.length)for(var o in e)i=e[o],0!==i.type.search(/^image/)||n||(n=i.src);!n&&this.poster&&(n=this.poster.src),n?(this.emit("media.loading"),this.mediaEl.src=n,this.currentItem=t):this.emit("media.error",new Error("No playable source"))}},_setBackgroundItem:{value:function(){this.parentEl.style["background-image"]='url("'+this.poster.src+'")'}},_playItem:{value:function(e,t){return this.isTouch?(this._setBackgroundItem(),void this._playImageItem()):("video"===this.currMediaType&&this._playVideoItem(e,t),"image"===this.currMediaType&&this._playImageItem(e,t),void(this._seeking=!1))}},_loadPlaylist:{value:function(e){this.playlist=e,this.playlistLength=e.length,this._playItem(e[0],0)}},_addListener:{value:function(e,t,i){e.addEventListener(t,i),this._listeners.push({element:e,event:t,handler:i})}},_removeAllListeners:{value:function(){var e,t=this._listeners;for(var i in t)e=t[i],e.element.removeEventListener(e.event,e.handler)}},_attachVideoListeners:{value:function(){function e(e){a._setVideoData(e),a.emit("media.metadata",e)}function t(){a.emit("media.playing",a.currentItem)}function i(){a.emit("media.pause")}function n(e){var t=null,i=e.target;i.buffered&&i.buffered.length>0&&i.buffered.end&&i.duration?t=i.buffered.end(0)/i.duration:"undefined"!=typeof i.bytesTotal&&i.bytesTotal>0&&"undefined"!=typeof i.bufferedBytes&&(t=i.bufferedBytes/i.bytesTotal),null!==t&&(t=100*Math.min(1,Math.max(0,t))),1===i.networkState&&0===i.readyState&&(t=100),a.emit("media.progress",t)}function o(){a._seeking||a.emit("media.ended",a.currentItem)}function s(){a.emit("media.canplay"),r.play(),a._seeking&&(a._seeking=!1)}var a=this,r=this.mediaEl;this._addListener(r,"loadedmetadata",e),this._addListener(r,"playing",t),this._addListener(r,"pause",i),this._addListener(r,"ended",o),this._addListener(r,"canplay",s),this._addListener(r,"progress",n,!1)}},_attachImageListeners:{value:function(){function e(){var e=new Event("ended");o.mediaEl.dispatchEvent(e)}function t(){o.emit("media.pause")}function i(){o.emit("media.canplay"),o._setImageData(this),o.emit("media.metadata",this),o.emit("media.playing",o.currentItem),o.isTouch||o.playlistLength>1&&(o._slideshowTimer&&o._slideshowTimer.destroy(),o._slideshowTimer=new r(e,1e3*o.slideshowItemDuration),o._slideshowTimer.on("pause",t))}function n(){o.emit("media.ended",o.currentItem)}var o=this,s=this.mediaEl;this._addListener(s,"load",i),this._addListener(s,"ended",n)}},_attachListeners:{value:function(){function e(){window.requestAnimationFrame(function(){s.metadataLoaded&&s._updateSize(a,s.currMediaType,s.mediaAspect)})}function t(){if(!this._seeking){var e=0;return s.playlistLength>1&&s.loopPlaylistItems?void("image"===s.currMediaType&&s.play(s.currentItem)):void(s.playlistLength>1&&s.loop&&(s.currentItem+1<s.playlistLength&&(e=s.currentItem+1),s.play(e)))}}function i(){a.style.opacity=1,s.canplay=!0}function n(){s.metadataLoaded=!0}function o(){s.canplay=!1,s.metadataLoaded=!1}var s=this,a=this.mediaEl;return this.isTouch?void this._attachImageListeners():(this._addListener(window,"resize",e),"video"===this.currMediaType?this._attachVideoListeners():this._attachImageListeners(),this.on("media.ended",t),this.on("media.canplay",i),this.on("media.metadata",n),void this.on("media.loading",o))}},_setParent:{value:function(e){return this.isTouch?d(e,{width:"100%",height:"100%",display:"block","background-position":"50% 50%","background-repeat":"no-repeat no-repeat","background-attachment":"local","background-size":"cover"}):d(e,{position:"absolute",display:"block",transform:"translate3d(-50%,-50%,0)","-webkit-transform":"translate3d(-50%,-50%,0)",left:"50%",top:"50%"}),e}},_cleanup:{value:function(){for(var e=this.parentEl;e.firstChild;)e.removeChild(e.firstChild)}},_createMediaEl:{value:function(){var e;return this.mediaEl&&this._cleanup(),this.isTouch?(this.currMediaType="image",e=f("img"),d(e,{display:"none"}),e):(this.slideshow?(this.currMediaType="image",e=f("img")):(this.currMediaType="video",e=f("video",{height:1,width:1,preload:"metadata"})),e?(e.style.opacity=0,d(e,{display:"block"}),e):void 0)}},_prepareContainer:{value:function(){var e=c();document.body.offsetHeight<e&&(d(document.body,{height:"auto"}),e>document.body.offsetHeight&&(d(document.body,{height:"100%"}),d(document.documentElement,{height:"100%"})))}},init:{value:function(e){e=e||{},this.isTouch=void 0!==e.isTouch?e.isTouch:"ontouchstart"in window||!!e.slideshow,this._prepareContainer(),this.parentEl=this._setParent(e.el);var t=this._createMediaEl();this.parentEl.appendChild(t),this.mediaEl=t,this._attachListeners()}},show:{value:function(e,t){return e.constructor===Array?this.showPlaylist([e],t):e.constructor===Object?this.showPlaylist([[e]],t):this.showPlaylist([l.makePlaylistItem(e)],t)}},showPlaylist:{value:function(e,t){t=t||{},t.hasOwnProperty("mute")&&(this.mute=t.mute),t.hasOwnProperty("loop")&&(this.loop=t.loop),t.hasOwnProperty("loopPlaylistItems")&&(this.loopPlaylistItems=t.loopPlaylistItems,this.loopPlaylistItems&&(this.loop=!1));var i=l.makePlaylist(e);this.poster=t.poster?"string"==typeof t.poster?{src:t.poster}:t.poster:p(i),this._loadPlaylist(i)}},setVolume:{value:function(e){"image"!==this.currMediaType&&(0===e?(this.mute=!0,this.mediaEl.muted=!0,this.mediaEl.volume=0):(this.mute=!1,this.mediaEl.muted=!1,this.mediaEl.volume=e))}},setPlaybackRate:{value:function(e){"image"!==this.currMediaType&&(this.mediaEl.playbackRate=e||1)}},getMedia:{value:function(){return this.mediaEl}},getPlaylist:{value:function(){return this.playlist}},getItem:{value:function(e){return this.playlist[e]}},play:{value:function(e){this._seeking=!0,"number"==typeof e?this._playItem(this.playlist[e],e):"video"===this.currMediaType?this.mediaEl.play():this._slideshowTimer&&this._slideshowTimer.resume()}},pause:{value:function(){"video"===this.currMediaType?this.mediaEl.pause():this._slideshowTimer&&this._slideshowTimer.pause()}},close:{value:function(){this._removeAllListeners(),this._cleanup(),this._slideshowTimer&&(this._slideshowTimer.destroy(),delete this._slideshowTimer)}},currentTime:{value:function(){return"video"===this.currMediaType?this.mediaEl.currentTime:this._slideshowTimer.currentTime()}},seekTo:{value:function(e){this._seeking=!0,"video"===this.currMediaType&&(this.mediaEl.currentTime=e)}},duration:{value:function(){return"video"===this.currMediaType?this.mediaEl.duration:this.slideshowItemDuration}}}),t}(a);t.exports=y},{"./playlist":3,"./timer":4,"./utils":5,jvent:6}],3:[function(e,t){"use strict";function i(e){var t={},i={mp4:!0,ogv:!0,webm:!0},n={jpg:!0,png:!0,gif:!0},o=e.replace(/[\?|\#].+/,"").match(/\.([mp4|ogv|webm|jpg|jpeg|png|gif]+)$/)[1];return i[o]&&(t.type="ogv"===o?"video/ogg":"video/"+o),n[o]&&(t.type="jpg"===o?"image/jpeg":"image/"+o),t.src=e,t}function n(e,t){t=t||0;var o,s=[];for(var a in e)o=e[a],o.constructor===Object&&s.push([o]),o.constructor===Array&&s.push(n(o,t+1)),"string"==typeof o&&s.push(0===t?[i(o)]:i(o));return s}t.exports={makePlaylist:n,makePlaylistItem:i}},{}],4:[function(e,t){"use strict";var i=function(e){return e&&e.__esModule?e["default"]:e},n=function(){function e(e,t){for(var i in t){var n=t[i];n.configurable=!0,n.value&&(n.writable=!0)}Object.defineProperties(e,t)}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)},s=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},a=i(e("jvent")),r=function(e){function t(e,i){s(this,t),this.callback=e,this.remaining=i,this.timerId=null,this.start=null,this.resume()}return o(t,e),n(t,{pause:{value:function(e){clearTimeout(timerId),this.remaining-=new Date-this.start,e||this.emit("pause")}},resume:{value:function(e){this.start=new Date,clearTimeout(this.timerId),this.timerId=setTimeout(this.callback,this.remaining),e||this.emit("resume")}},currentTime:{value:function(){var e=new Date-this.start;return this.timerId&&(this.pause(!0),this.resume(!0)),e}},destroy:{value:function(){this.pause(!0),this.removeAllListeners()}}}),t}(a);t.exports=r},{jvent:6}],5:[function(e,t){"use strict";function i(){return self.innerHeight?self.innerWidth:document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:document.body?document.body.clientWidth:void 0}function n(){return self.innerHeight?self.innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:document.body?document.body.clientHeight:void 0}function o(e,t){var i="";for(var n in t)i+=n+":"+t[n]+";";e.style.cssText+=";"+i}function s(e){var t,i;for(var n in e){if(i=e[n],i.constructor===Array)t=s(i);else if(i.type.search(/^image/)>-1)return i;if(t)return t}}function a(e,t){[].slice.call(e).forEach(t)}function r(e,t){var i=e.children||e.childNodes;i.length&&a(i,function(i){var n=t.shift();n?e.replaceChild(n,i):e.removeChild(i)}),t.length&&t.forEach(function(t){e.appendChild(t)})}function l(e,t){var i=document.createElement(e);for(var n in t)i[n]=t[n];return i}t.exports={getWidth:i,getHeight:n,setStyles:o,findPoster:s,eachNode:a,replaceChildren:r,createEl:l}},{}],6:[function(e,t){"use strict";function i(){}i.prototype.on=function(e,t){return this._collection=this._collection||{},this._collection[e]=this._collection[e]||[],this._collection[e].push(t),this},i.prototype.once=function(e,t){function i(){n.off(e,i),t.apply(this,arguments)}var n=this;return i.listener=t,this.on(e,i),this},i.prototype.off=function(e,t){var i=this._collection[e],n=0;if(void 0!==i)for(n;n<i.length;n+=1)if(i[n]===t||i[n].listener===t){i.splice(n,1);break}return 0===i.length&&this.removeAllListeners(e),this},i.prototype.removeAllListeners=function(e){return this._collection=this._collection||{},delete this._collection[e],this},i.prototype.listeners=function(e){return this._collection=this._collection||{},this._collection[e]},i.prototype.emit=function(){if(void 0===this._collection)return this;var e,t=[].slice.call(arguments,0),i=t.shift(),n=this._collection[i],o=0;if(n)for(n=n.slice(0),e=n.length,o;e>o;o+=1)n[o].apply(this,t);return this},t.exports=i},{}],7:[function(e,t,i){(function(n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=function(e,t,i){for(var n=!0;n;){r=u=l=void 0,n=!1;var o=e,s=t,a=i,r=Object.getOwnPropertyDescriptor(o,s);if(void 0!==r){if("value"in r)return r.value;var l=r.get;return void 0===l?void 0:l.call(a)}var u=Object.getPrototypeOf(o);if(null===u)return void 0;e=u,t=s,i=a,n=!0}},u="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,h=o(u),c=e("drive-in"),d=o(c),p=function(e){function t(e){s(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e);this.state={className:"drive-in",mute:!0,loop:!0,loopPaylistItems:!1,slideshow:!1,volume:.5,onTimeFrequency:500}}return a(t,e),r(t,[{key:"getMedia",value:function(){return this.refs.media.getDOMNode()}},{key:"getPlaylist",value:function(){return this.state.playlist}},{key:"setPlaying",value:function(e){this.setState({playing:!0,currentItem:e}),this.props.onPlaying&&this.props.onPlaying(e)}},{key:"setPause",value:function(){this.setState({playing:!1}),this.props.onPause&&this.props.onPause()}},{key:"setLoading",value:function(){this.setState({canPlay:!1})}},{key:"setCanPlay",value:function(){this.setState({canPlay:!0}),this.props.onCanPlay&&this.props.onCanPlay()}},{key:"componentWillMount",value:function(){this.DI=new d["default"]}},{key:"componentDidMount",value:function(){var e,t,i=this,n=this.DI;n.init({el:this.getMedia(),slideshow:this.props.slideshow}),e={mute:this.props.mute,loop:this.props.loop,loopPlaylistItems:this.props.loopPlaylistItems,poster:this.props.poster,isTouch:this.props.isTouch},t=this.props.showPlaylist?n.showPlaylist(this.props.showPlaylist,e):n.show(this.props.show,e),n.on("media.playing",function(e){i.setPlaying(e)}),n.on("media.pause",function(){i.setPause()}),n.on("media.loading",function(){i.setLoading()}),n.on("media.canplay",function(){i.setCanPlay()}),this.props.onTime&&(this.intervalId=window.setInterval(function(){var e=n.currentTime();i.props.onTime(e)},this.props.onTimeFrequency)),this.props.playbackRate&&this.playbackRate(this.props.playbackRate),this.setState({mute:this.props.mute,playlist:t,initalized:!0})}},{key:"componentWillUnmount",value:function(){this.intervalId&&window.clearInterval(this.intervalId),this.DI.removeAllListeners(),this.DI.close(),delete this.DI}},{key:"play",value:function(e){this.DI.play(e)}},{key:"pause",value:function(){this.DI.pause()}},{key:"mute",value:function(){this.DI.setVolume(0),this.setState({mute:!0})}},{key:"unmute",value:function(){this.DI.setVolume(this.props.volume),this.setState({mute:!1})}},{key:"playbackRate",value:function(e){e=e||1,this.DI.setPlaybackRate(e),this.setState({playbackRate:e})}},{key:"seekTo",value:function(e){this.DI.seekTo(e)}},{key:"duration",value:function(){return this.DI.duration()}},{key:"render",value:function(){return h["default"].createElement("div",{ref:"wrap",id:"drive-in-wrap",className:this.props.className},h["default"].createElement("div",{ref:"media",className:"drive-in-media"}))}}]),t}(h["default"].Component);p.displayName="DriveIn",p.propTypes={show:h["default"].PropTypes.oneOfType([h["default"].PropTypes.string,h["default"].PropTypes.array]),showPlaylist:h["default"].PropTypes.oneOfType([h["default"].PropTypes.array]),poster:h["default"].PropTypes.string,mute:h["default"].PropTypes.bool,loop:h["default"].PropTypes.bool,loopPlaylistItems:h["default"].PropTypes.bool,playbackRate:h["default"].PropTypes.number,slideshow:h["default"].PropTypes.bool,onPlaying:h["default"].PropTypes.func,onPause:h["default"].PropTypes.func,onTime:h["default"].PropTypes.func,onTimeFrequency:h["default"].PropTypes.number,onCanPlay:h["default"].PropTypes.func,isTouch:h["default"].PropTypes.func},p.defaultProps={className:"drive-in",mute:!0,loop:!0,loopPaylistItems:!1,slideshow:!1,volume:.5,onTimeFrequency:500},i["default"]=p,t.exports=i["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"drive-in":1}]},{},[7])(7)});