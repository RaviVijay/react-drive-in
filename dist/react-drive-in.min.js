/*
 * React Video - React component supporting background videos and playlists.
 * @version v1.3.0
 * @link https://github.com/ronik-design/react-drive-in
 * @license ISC
 * @author Ronik Design (http://www.ronikdesign.com)
*/
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("react")):"function"==typeof define&&define.amd?define(["react"],e):"object"==typeof exports?exports.ReactDriveIn=e(require("react")):t.ReactDriveIn=e(t.React)}(this,function(t){return function(t){function e(o){if(i[o])return i[o].exports;var s=i[o]={exports:{},id:o,loaded:!1};return t[o].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){var o=i(1),s=i(2);t.exports=o.createClass({displayName:"DriveIn",propTypes:{show:o.PropTypes.oneOfType([o.PropTypes.string,o.PropTypes.array]),showPlaylist:o.PropTypes.oneOfType([o.PropTypes.array]),poster:o.PropTypes.string,duration:o.PropTypes.number,mute:o.PropTypes.bool,loop:o.PropTypes.bool,loopPlaylistItems:o.PropTypes.bool,playbackRate:o.PropTypes.number,slideshow:o.PropTypes.bool,onPlaying:o.PropTypes.func,onPause:o.PropTypes.func,onTime:o.PropTypes.func,onTimeFrequency:o.PropTypes.number,onCanPlay:o.PropTypes.func},getDefaultProps:function(){return{className:"drive-in",duration:"auto",mute:!0,loop:!0,loopPaylistItems:!1,slideshow:!1,volume:.5,onTimeFrequency:500}},getInitialState:function(){return{playlist:null,initialized:!1,playing:!1,mute:!0,currentItem:0,playbackRate:1}},getMedia:function(){return this.refs.media.getDOMNode()},getPlaylist:function(){return this.state.playlist},setPlaying:function(t){this.setState({playing:!0,currentItem:t}),this.props.onPlaying&&this.props.onPlaying(t)},setPause:function(){this.setState({playing:!1}),this.props.onPause&&this.props.onPause()},setLoading:function(){this.setState({canPlay:!1})},setCanPlay:function(){this.setState({canPlay:!0}),this.props.onCanPlay&&this.props.onCanPlay()},componentWillMount:function(){this.DI=new s},componentDidMount:function(){var t,e,i=this.DI;i.init({el:this.getMedia(),slideshow:this.props.slideshow}),t={mute:this.props.mute,duration:this.props.duration,loop:this.props.loop,loopPlaylistItems:this.props.loopPlaylistItems,poster:this.props.poster},e=this.props.showPlaylist?i.showPlaylist(this.props.showPlaylist,t):i.show(this.props.show,t),i.on("media.playing",function(t){this.setPlaying(t)}.bind(this)),i.on("media.pause",function(){this.setPause()}.bind(this)),i.on("media.loading",function(){this.setLoading()}.bind(this)),i.on("media.canplay",function(){this.setCanPlay()}.bind(this)),this.props.onTime&&(this.intervalId=window.setInterval(function(){var t=i.currentTime();this.props.onTime(t)}.bind(this),this.props.onTimeFrequency)),this.props.playbackRate&&this.playbackRate(this.props.playbackRate),this.setState({mute:this.props.mute,playlist:e,initalized:!0})},componentWillUnmount:function(){this.intervalId&&window.clearInterval(this.intervalId),this.DI.removeAllListeners(),this.DI.close(),delete this.DI},play:function(t){this.DI.play(t)},pause:function(){this.DI.pause()},mute:function(){this.DI.setVolume(0),this.setState({mute:!0})},unmute:function(){this.DI.setVolume(this.props.volume),this.setState({mute:!1})},playbackRate:function(t){t=t||1,this.DI.setPlaybackRate(t),this.setState({playbackRate:t})},seekTo:function(t){this.DI.seekTo(t)},duration:function(){return this.DI.duration()},render:function(){return o.DOM.div({ref:"wrap",id:"drive-in-wrap",className:this.props.className},o.DOM.div({ref:"media",className:"drive-in-media"}))}})},function(e){e.exports=t},function(t,e,i){t.exports=i(3)},function(t,e,i){function o(){this._listeners=[],this.parentEl=null,this.mediaEl=null,this.placeholderEl=null,this.mute=!0,this.currMediaType=null,this.mediaAspect=16/9,this.playlist=null,this.loop=!0,this.loopPlaylistItems=!1,this.slideshow=!1,this.playlistLength=0,this.currentItem=0,this.slideshowItemDuration=10,this._slideshowTimer=null,this._seeking=!1,this.poster=null,this.loading=!0}var s=i(7),n=i(8),r=i(4),a=i(5),l=i(6),p=l.getWidth,h=l.getHeight,u=l.setStyles,c=l.findPoster,d=l.createEl,m=l.replaceChildren;n(o,s),o.prototype._updateSize=function(t,e,i){var o=1,s=p(),n=h(),r=s/n;i>r?(u(this.parentEl,{width:Math.ceil(n*i)+"px",height:n+o+"px"}),"video"===e?u(t,{width:Math.ceil(n*i)+"px",height:n+"px"}):u(t,{width:"auto",height:n+o+"px"})):(u(this.parentEl,{width:s+"px",height:Math.ceil(s/i)+1+"px"}),"video"===e?u(t,{width:this.parentEl.offsetWidth+"px",height:"auto"}):u(t,{width:s+"px",height:"auto"}))},o.prototype._setVideoData=function(){var t=this.mediaEl;this.mediaAspect=t.videoWidth/t.videoHeight,this._updateSize(t,"video",this.mediaAspect)},o.prototype._setImageData=function(t){this.mediaAspect=t.naturalWidth/t.naturalHeight,this.isTouch||this._updateSize(this.mediaEl,"image",this.mediaAspect)},o.prototype._playVideoItem=function(t,e){for(var i,o,s,n,r=this.mediaEl,a=[],l=t.length-1;l>=0;l--)i=t[l],0!==i.type.search(/^image/)||s?o=d("source",{src:i.src,type:i.type}):s=i.src,o&&(n=r.canPlayType(i.type),"probably"===n?a.unshift(o):a.push(o));a.length?(this.emit("media.loading"),r.preload="auto",(this.playlistLength<2||this.loopPlaylistItems)&&(r.loop=!0),this.mute&&this.setVolume(0),s&&(r.poster=s),m(r,a),this.currentItem=e,r.load()):s||this.poster?(this.slideshow=!0,this._createMediaEl(),this._playImageItem(t,e)):this.emit("media.error",new Error("No playable source"))},o.prototype._playImageItem=function(t,e){var i,o;if(t&&t.length)for(var s in t)i=t[s],0!==i.type.search(/^image/)||o||(o=i.src);!o&&this.poster&&(o=this.poster.src),o?(this.emit("media.loading"),this.mediaEl.src=o,this.currentItem=e):this.emit("media.error",new Error("No playable source"))},o.prototype._setBackgroundItem=function(){this.parentEl.style["background-image"]='url("'+this.poster.src+'")'},o.prototype._playItem=function(t,e){return this.isTouch?(this._setBackgroundItem(),void this._playImageItem()):("video"===this.currMediaType&&this._playVideoItem(t,e),"image"===this.currMediaType&&this._playImageItem(t,e),void(this._seeking=!1))},o.prototype._loadPlaylist=function(t){this.playlist=t,this.playlistLength=t.length,this._playItem(t[0],0)},o.prototype._addListener=function(t,e,i){t.addEventListener(e,i),this._listeners.push({element:t,event:e,handler:i})},o.prototype._removeAllListeners=function(){var t,e=this._listeners;for(var i in e)t=e[i],t.element.removeEventListener(t.event,t.handler)},o.prototype._attachVideoListeners=function(){function t(t){r._setVideoData(t),r.emit("media.metadata",t)}function e(){r.emit("media.playing",r.currentItem)}function i(){r.emit("media.pause")}function o(t){var e=null,i=t.target;i.buffered&&i.buffered.length>0&&i.buffered.end&&i.duration?e=i.buffered.end(0)/i.duration:"undefined"!=typeof i.bytesTotal&&i.bytesTotal>0&&"undefined"!=typeof i.bufferedBytes&&(e=i.bufferedBytes/i.bytesTotal),null!==e&&(e=100*Math.min(1,Math.max(0,e))),1===i.networkState&&0===i.readyState&&(e=100),r.emit("media.progress",e)}function s(){r._seeking||r.emit("media.ended",r.currentItem)}function n(){r.emit("media.canplay"),a.play(),r._seeking&&(r._seeking=!1)}var r=this,a=this.mediaEl;this._addListener(a,"loadedmetadata",t),this._addListener(a,"playing",e),this._addListener(a,"pause",i),this._addListener(a,"ended",s),this._addListener(a,"canplay",n),this._addListener(a,"progress",o,!1)},o.prototype._attachImageListeners=function(){function t(){var t=new Event("ended");s.mediaEl.dispatchEvent(t)}function e(){s.emit("media.pause")}function i(){s.emit("media.canplay"),s._setImageData(this),s.emit("media.metadata",this),s.emit("media.playing",s.currentItem),s.isTouch||s.playlistLength>1&&(s._slideshowTimer&&s._slideshowTimer.destroy(),s._slideshowTimer=new r(t,1e3*s.slideshowItemDuration),s._slideshowTimer.on("pause",e))}function o(){s.emit("media.ended",s.currentItem)}var s=this,n=this.mediaEl;this._addListener(n,"load",i),this._addListener(n,"ended",o)},o.prototype._attachListeners=function(){function t(){window.requestAnimationFrame(function(){n.metadataLoaded&&n._updateSize(r,n.currMediaType,n.mediaAspect)})}function e(){if(!this._seeking){var t=0;return n.playlistLength>1&&n.loopPlaylistItems?void("image"===n.currMediaType&&n.play(n.currentItem)):void(n.playlistLength>1&&n.loop&&(n.currentItem+1<n.playlistLength&&(t=n.currentItem+1),n.play(t)))}}function i(){r.style.opacity=1,n.canplay=!0}function o(){n.metadataLoaded=!0}function s(){n.canplay=!1,n.metadataLoaded=!1}var n=this,r=this.mediaEl;return this.isTouch?void this._attachImageListeners():(this._addListener(window,"resize",t),"video"===this.currMediaType?this._attachVideoListeners():this._attachImageListeners(),this.on("media.ended",e),this.on("media.canplay",i),this.on("media.metadata",o),void this.on("media.loading",s))},o.prototype._setParent=function(t){return this.isTouch?u(t,{width:"100%",height:"100%",display:"block","background-position":"50% 50%","background-repeat":"no-repeat no-repeat","background-attachment":"local","background-size":"cover"}):u(t,{position:"absolute",display:"block",transform:"translate3d(-50%,-50%,0)","-webkit-transform":"translate3d(-50%,-50%,0)",left:"50%",top:"50%"}),t},o.prototype._cleanup=function(){for(var t=this.parentEl;t.firstChild;)t.removeChild(t.firstChild)},o.prototype._createMediaEl=function(){var t;return this.mediaEl&&this._cleanup(),this.isTouch?(this.currMediaType="image",t=d("img"),u(t,{display:"none"}),t):(this.slideshow?(this.currMediaType="image",t=d("img")):(this.currMediaType="video",t=d("video",{height:1,width:1,preload:"metadata"})),t?(t.style.opacity=0,u(t,{display:"block"}),t):void 0)},o.prototype._prepareContainer=function(){var t=h();document.body.offsetHeight<t&&(u(document.body,{height:"auto"}),t>document.body.offsetHeight&&(u(document.body,{height:"100%"}),u(document.documentElement,{height:"100%"})))},o.prototype.init=function(t){t=t||{},("ontouchstart"in window||t.slideshow)&&(this.isTouch=!0),this._prepareContainer(),this.parentEl=this._setParent(t.el);var e=this._createMediaEl();this.parentEl.appendChild(e),this.mediaEl=e,this._attachListeners()},o.prototype.show=function(t,e){return t.constructor===Array?this.showPlaylist([t],e):t.constructor===Object?this.showPlaylist([[t]],e):this.showPlaylist([a.makePlaylistItem(t)],e)},o.prototype.showPlaylist=function(t,e){e=e||{},e.hasOwnProperty("mute")&&(this.mute=e.mute),e.hasOwnProperty("loop")&&(this.loop=e.loop),e.hasOwnProperty("loopPlaylistItems")&&(this.loopPlaylistItems=e.loopPlaylistItems,this.loopPlaylistItems&&(this.loop=!1));var i=a.makePlaylist(t);this.poster=e.poster?e.poster:c(i),this._loadPlaylist(i)},o.prototype.setVolume=function(t){"image"!==this.currMediaType&&(0===t?(this.mute=!0,this.mediaEl.muted=!0,this.mediaEl.volume=0):(this.mute=!1,this.mediaEl.muted=!1,this.mediaEl.volume=t))},o.prototype.setPlaybackRate=function(t){"image"!==this.currMediaType&&(this.mediaEl.playbackRate=t||1)},o.prototype.getMedia=function(){return this.mediaEl},o.prototype.getPlaylist=function(){return this.playlist},o.prototype.getItem=function(t){return this.playlist[t]},o.prototype.play=function(t){this._seeking=!0,"number"==typeof t?this._playItem(this.playlist[t],t):"video"===this.currMediaType?this.mediaEl.play():this._slideshowTimer&&this._slideshowTimer.resume()},o.prototype.pause=function(){"video"===this.currMediaType?this.mediaEl.pause():this._slideshowTimer&&this._slideshowTimer.pause()},o.prototype.close=function(){this._removeAllListeners(),this._cleanup(),this._slideshowTimer&&(this._slideshowTimer.destroy(),delete this._slideshowTimer)},o.prototype.currentTime=function(){return"video"===this.currMediaType?this.mediaEl.currentTime:this._slideshowTimer.currentTime()},o.prototype.seekTo=function(t){this._seeking=!0,"video"===this.currMediaType&&(this.mediaEl.currentTime=t)},o.prototype.duration=function(){return"video"===this.currMediaType?this.mediaEl.duration:this.slideshowItemDuration},t.exports=o},function(t,e,i){function o(t,e){var i,o,s=this,n=e;this.pause=function(t){window.clearTimeout(i),n-=new Date-o,t||this.emit("pause")},this.resume=function(e){o=new Date,window.clearTimeout(i),i=window.setTimeout(t,n),e||this.emit("resume")},this.currentTime=function(){var t=new Date-o;return i&&(this.pause(!0),this.resume(!0)),t},this.destroy=function(){s.pause(!0),s.removeAllListeners()},this.resume()}var s=i(7),n=i(8);n(o,s),t.exports=o},function(t,e){function i(t){var e={},i={mp4:!0,ogv:!0,webm:!0},o={jpg:!0,png:!0,gif:!0},s=t.replace(/[\?|\#].+/,"").match(/\.([mp4|ogv|webm|jpg|jpeg|png|gif]+)$/)[1];return i[s]&&(e.type="ogv"===s?"video/ogg":"video/"+s),o[s]&&(e.type="jpg"===s?"image/jpeg":"image/"+s),e.src=t,e}function o(t,e){e=e||0;var s,n=[];for(var r in t)s=t[r],s.constructor===Object&&n.push([s]),s.constructor===Array&&n.push(o(s,e+1)),"string"==typeof s&&n.push(0===e?[i(s)]:i(s));return n}e.makePlaylist=o,e.makePlaylistItem=i},function(t){var e={};e.getWidth=function(){return self.innerHeight?self.innerWidth:document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:document.body?document.body.clientWidth:void 0},e.getHeight=function(){return self.innerHeight?self.innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:document.body?document.body.clientHeight:void 0},e.setStyles=function(t,e){var i="";for(var o in e)i+=o+":"+e[o]+";";t.style.cssText+=";"+i},e.findPoster=function(t){var i,o;for(var s in t){if(o=t[s],o.constructor===Array)i=e.findPoster(o);else if(o.type.search(/^image/)>-1)return o;if(i)return i}},e.eachNode=function(t,e){[].slice.call(t).forEach(e)},e.replaceChildren=function(t,i){var o=t.children||t.childNodes;o.length&&e.eachNode(o,function(e){var o=i.shift();o?t.replaceChild(o,e):t.removeChild(e)}),i.length&&i.forEach(function(e){t.appendChild(e)})},e.createEl=function(t,e){var i=document.createElement(t);for(var o in e)i[o]=e[o];return i},t.exports=e},function(t){"use strict";function e(){}e.prototype.on=function(t,e){return this._collection=this._collection||{},this._collection[t]=this._collection[t]||[],this._collection[t].push(e),this},e.prototype.once=function(t,e){function i(){o.off(t,i),e.apply(this,arguments)}var o=this;return i.listener=e,this.on(t,i),this},e.prototype.off=function(t,e){var i=this._collection[t],o=0;if(void 0!==i)for(o;o<i.length;o+=1)if(i[o]===e||i[o].listener===e){i.splice(o,1);break}return 0===i.length&&this.removeAllListeners(t),this},e.prototype.removeAllListeners=function(t){return this._collection=this._collection||{},delete this._collection[t],this},e.prototype.listeners=function(t){return this._collection=this._collection||{},this._collection[t]},e.prototype.emit=function(){if(void 0===this._collection)return this;var t,e=[].slice.call(arguments,0),i=e.shift(),o=this._collection[i],s=0;if(o)for(o=o.slice(0),t=o.length,s;t>s;s+=1)o[s].apply(this,e);return this},t.exports=e},function(t){t.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}}])});